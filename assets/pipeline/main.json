{
    "Main": {
        "next": "SetScreen",
    },
    "SetScreen": {
        "action": "Command",
        "exec": "adb",
        "args": ["shell", "wm", "size", "1080x1920"],
        "next": "Launch",
    },
    "Launch": {
        "action": "StartApp",
        "package": "com.supercell.clashofclans",
        "next": "AttackLoop",
    },
    "AttackLoop": {
        "focus": "AttackLoop!",
        "next": [
            "Exception",
            "AttackStart",
            "SearchOpponent",
            "FindNext",
            "GiveUp",
            "BackHome",
            "CloseDialog",
        ],
        "timeout": 10000,
        "on_error": "Main",
    },
    "AttackStart": {
        "focus": "AttackStart!",
        "recognition": "TemplateMatch",
        "template": ["AttackStart.png","AttackStartWithStar.png"],
        "green_mask": true,
        "roi": [33,543,178,176],
        "threshold": 0.85,
        "action": "Click",
        "next": "SearchOpponent",
        "timeout": 1000,
        "on_error": "AttackLoop",
    },
    "SearchOpponent": {
        "focus": "SearchOpponent!",
        "recognition": "TemplateMatch",
        "template": "SearchOpponent.png",
        "roi": [756,314,317,193],
        "action": "Click",
        "next": "FindNext",
        "timeout": 10000,
        "on_error": "AttackLoop",
    },
    "FindNext": {
        "recognition": "TemplateMatch",
        "template": "Next.png",
        "roi": [1005,440,253,146],
        "next": "SlideLeft",
    },
    "SlideLeft": {
        "action": "Swipe",
        "begin": [200,250,50,50],
        "end": [1200,250,50,50],
        "duration": 100,
        "next": "Deploy",
    },

    "Deploy": {
        "focus": "Deploy!",
        "next": [
            "FindSpell",
            "FindSoldier",
            "FindHero",
        ],
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
        "timeout": 0,
        "on_error": "WaitingEndLoop",
    },
    "FindSoldier": {
        "focus": "FindSoldier!",
        "recognition": "TemplateMatch",
        "template": "Soldier",
        "roi": [46,584,1191,135],
        "threshold": 0.95,
        "action": "Click",
        "next": "DeploySoldier",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "DeploySoldier": {
        "action": "LongPress",
        "target": [111,317,43,50],
        "duration": 4000,
        "next": "Deploy",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "FindHero": {
        "focus": "FindHero!",
        "recognition": "TemplateMatch",
        "template": "Hero",
        "roi": [46,584,1191,135],
        "threshold": 0.85,
        "action": "Click",
        "target_offset": [0,0,0,-30],
        "next": "DeployHero",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "DeployHero": {
        "action": "Click",
        "target": [111,317,43,50],
        "next": "SkillHero",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "SkillHero": {
        "action": "Click",
        "target": "FindHero",
        "next": "Deploy",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "FindSpell": {
        "focus": "FindSpell!",
        "recognition": "TemplateMatch",
        "template": "Spell",
        "roi": [46,584,1191,135],
        "threshold": 0.85,
        "action": "Click",
        "next": "DeploySpell",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "DeploySpell": {
        "action": "Click",
        "target": [297,199,341,318],
        "next": "Deploy",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },

    "GiveUp": {
        "focus": "GiveUp!",
        "recognition": "TemplateMatch",
        "template": "GiveUp.png",
        "roi": [20,483,218,107],
        "action": "Click",
        "next": ["GiveUpYes","TryBackHome"],
    },
    "GiveUpYes": {
        "recognition": "TemplateMatch",
        "template": "GiveUpYes.png",
        "roi": [631,389,308,153],
        "action": "Click",
        "next": "TryBackHome",
    },

    "WaitingEndLoop": {
        "focus": "WaitingEndLoop!",
        "next": "WaitingEnd",
        "timeout": 1000,
        "on_error": "WaitingEndLoop",
    },
    "WaitingEnd": {
        "recognition": "TemplateMatch",
        "template": "GiveUp.png",
        "roi": [20,483,218,107],
        "inverse": true,
        "next": "TryBackHome",
    },

    "TryBackHome": {
        "next": "BackHome",
        "timeout": 1000,
        "on_error": "AttackLoop",
    },
    "BackHome": {
        "focus": "BackHome!",
        "recognition": "TemplateMatch",
        "template": "BackHome.png",
        "roi": [528,546,228,139],
        "threshold": 0.8,
        "action": "Click",
        "next": "AttackStart",
        "timeout": 10000,
        "on_error": "AttackLoop",
    },

    "Exception": {
        "focus": "Exception!",
        "recognition": "TemplateMatch",
        "template": "Exception",
        "threshold": 0.9,
        "next": "ExceptionConfirmation",
    },
    "ExceptionConfirmation": {
        "recognition": "TemplateMatch",
        "template": "ExceptionConfirmation",
        "action": "Click",
        "next": "Main",
    },

    "CloseDialog": {
        "focus": "CloseDialog!",
        "recognition": "TemplateMatch",
        "template": "CloseButton",
        "threshold": 0.8,
        "action": "Click",
        "next": "AttackLoop",
    },
}