{
    "Main": {
        "next": "SetScreen",
    },
    "SetScreen": {
        "action": "Command",
        "exec": "adb",
        "args": ["shell", "wm", "size", "1080x1920"],
        "next": "Launch",
    },
    "Launch": {
        "action": "StartApp",
        "package": "com.supercell.clashofclans",
        "next": "AttackLoop",
    },
    "AttackLoop": {
        "focus": "AttackLoop!",
        "next": [
            "Exception",
            "AttackStart",
            "FindMatch",
            "FindNext",
            "Surrender",
            "ReturnHome",
            "OpenBox",
            "OpenBoxTap",
            "CloseDialog",
        ],
        "timeout": 10000,
        "on_error": "Main",
    },
    "AttackStart": {
        "focus": "AttackStart!",
        "recognition": "TemplateMatch",
        "template": "AttackStart",
        "green_mask": true,
        "roi": [33,543,178,176],
        "threshold": 0.85,
        "action": "Click",
        "next": "FindMatch",
        "timeout": 1000,
        "on_error": "AttackLoop",
    },
    "FindMatch": {
        "focus": "FindMatch!",
        "recognition": "TemplateMatch",
        "template": "FindMatch",
        "roi": [79,459,342,155],
        "action": "Click",
        "next": "FindNext",
        "timeout": 10000,
        "on_error": "AttackLoop",
    },
    "FindNext": {
        "recognition": "TemplateMatch",
        "template": "Next",
        "green_mask": true,
        "roi": [1005,440,253,146],
        "next": "SlideLeft",
    },
    "SlideLeft": {
        "action": "Swipe",
        "begin": [200,250,50,1],
        "end": [1200,250,50,1],
        "duration": 100,
        "next": "Deploy",
    },

    "Deploy": {
        "focus": "Deploy!",
        "next": [
            "ReturnHome",
            "FindSpell",
            "FindSoldier",
            "FindVehicle",
            "FindHero",
        ],
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
        "timeout": 0,
        "on_error": "WaitingEndLoop",
    },
    "FindSoldier": {
        "focus": "FindSoldier!",
        "recognition": "TemplateMatch",
        "template": "Soldier",
        "green_mask": true,
        "roi": [46,584,1191,135],
        "threshold": 0.90,
        "action": "Click",
        "next": "DeploySoldier",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "DeploySoldier": {
        "action": "LongPress",
        "target": [111,317,43,50],
        "duration": 4000,
        "next": "Deploy",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "FindVehicle": {
        "focus": "FindVehicle!",
        "recognition": "TemplateMatch",
        "template": "Vehicle",
        "green_mask": true,
        "roi": [46,584,1191,135],
        "threshold": 0.90,
        "action": "Click",
        "target_offset": [0,0,0,-30],
        "next": "DeployVehicle",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "DeployVehicle": {
        "action": "Click",
        "target": [111,317,43,50],
        "next": "Deploy",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "FindHero": {
        "focus": "FindHero!",
        "recognition": "TemplateMatch",
        "template": "Hero",
        "green_mask": true,
        "roi": [46,584,1191,135],
        "threshold": 0.90,
        "action": "Click",
        "target_offset": [0,0,0,-30],
        "next": "DeployHero",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "DeployHero": {
        "action": "Click",
        "target": [111,317,43,50],
        "next": "SkillHero",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "SkillHero": {
        "action": "Click",
        "target": "FindHero",
        "next": "Deploy",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "FindSpell": {
        "focus": "FindSpell!",
        "recognition": "TemplateMatch",
        "template": "Spell",
        "green_mask": true,
        "roi": [46,584,1191,135],
        "threshold": 0.90,
        "action": "Click",
        "next": "DeploySpell1",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "DeploySpell1": {
        "action": "Click",
        "target": [229,307,47,55],
        "next": "DeploySpell2",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "DeploySpell2": {
        "action": "Click",
        "target": [311,230,52,57],
        "next": "DeploySpell3",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "DeploySpell3": {
        "action": "Click",
        "target": [308,375,58,56],
        "next": "DeploySpell4",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "DeploySpell4": {
        "action": "Click",
        "target": [404,179,50,52],
        "next": "DeploySpell5",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },
    "DeploySpell5": {
        "action": "Click",
        "target": [401,425,57,56],
        "next": "Deploy",
        "rate_limit": 10,
        "pre_delay": 0,
        "post_delay": 0,
    },

    "Surrender": {
        "focus": "Surrender!",
        "recognition": "TemplateMatch",
        "template": "Surrender",
        "roi": [20,483,218,107],
        "action": "Click",
        "next": ["SurrenderConfirmation","TryReturnHome"],
    },
    "SurrenderConfirmation": {
        "recognition": "TemplateMatch",
        "template": "Okay",
        "roi": [631,389,308,153],
        "action": "Click",
        "next": "TryReturnHome",
    },

    "WaitingEndLoop": {
        "focus": "WaitingEndLoop!",
        "next": "WaitingEnd",
        "timeout": 1000,
        "on_error": "WaitingEndLoop",
    },
    "WaitingEnd": {
        "recognition": "TemplateMatch",
        "template": "Surrender",
        "roi": [20,483,218,107],
        "inverse": true,
        "next": "TryReturnHome",
    },

    "TryReturnHome": {
        "next": ["ReturnHome","OpenBox"],
        "timeout": 1000,
        "on_error": "AttackLoop",
    },
    "ReturnHome": {
        "focus": "ReturnHome!",
        "recognition": "TemplateMatch",
        "template": "ReturnHome",
        "roi": [528,546,228,139],
        "threshold": 0.8,
        "action": "Click",
        "next": ["RewardOkay","AttackStart"],
        "timeout": 10000,
        "on_error": "AttackLoop",
    },
    "RewardOkay": {
        "recognition": "TemplateMatch",
        "template": "RewardOkay",
        "roi": [521,558,255,116],
        "threshold": 0.8,
        "action": "Click",
        "next": "AttackStart",
        "on_error": "AttackLoop",
    },
    "OpenBox": {
        "focus": "OpenBox!",
        "recognition": "TemplateMatch",
        "template": "OpenBox",
        "roi": [500,546,300,139],
        "threshold": 0.8,
        "action": "Click",
        "next": ["OpenBoxTap"],
        "on_error": "AttackLoop",
    },
    "OpenBoxTap": {
        "recognition": "TemplateMatch",
        "template": "OpenBoxTap",
        "roi": [480,530,300,140],
        "threshold": 0.8,
        "action": "Click",
        "target": [525,290,214,200],
        "next": ["OpenBoxTap","OpenBoxContinue"],
        "on_error": "AttackLoop",
    },
    "OpenBoxContinue": {
        "recognition": "TemplateMatch",
        "template": "OpenBoxContinue",
        "roi": [515,535,255,102],
        "threshold": 0.8,
        "action": "Click",
        "next": "AttackStart",
        "on_error": "AttackLoop",
    },

    "Exception": {
        "focus": "Exception!",
        "recognition": "TemplateMatch",
        "template": "Exception",
        "threshold": 0.9,
        "next": "ExceptionConfirmation",
    },
    "ExceptionConfirmation": {
        "recognition": "TemplateMatch",
        "template": "ExceptionConfirmation",
        "action": "Click",
        "next": "Main",
    },

    "CloseDialog": {
        "focus": "CloseDialog!",
        "recognition": "TemplateMatch",
        "template": "CloseButton",
        "threshold": 0.8,
        "action": "Click",
        "next": "AttackLoop",
    },
}